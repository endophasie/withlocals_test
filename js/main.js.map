{"version":3,"file":"main.js","sources":["js/loader.js","js/abstract-view.js","js/trip-list-view.js","js/trip-list-screen.js","js/trip-page-view.js","js/trip-page-screen.js","js/app.js","js/main.js"],"sourcesContent":["const SERVER_URL = 'https://www.withlocals.com/api/v1/experience/searchWithOthers?adults=2&children=0&date.from=2019-05-10&date.to=2019-05-10&fieldset=reactsearch&lang=en&location.city=rome&location.country=italy&page=1&pagesize=47';\n\nconst checkStatus = (response) => {\n  if (response.status >= 200 && response.status < 300) {\n    return response;\n  }\n  throw new Error(`${response.status}: ${response.statusText}`);\n};\n\nconst toJSON = (response) => response.json();\n\nclass Loader {\n  static loadData() {\n    return fetchJsonp(`${SERVER_URL}`)\n      .then(checkStatus)\n      .then(toJSON);\n  }\n}\n\nexport default Loader;\n","const render = (template) => {\n    const el = document.createElement('section');\n    el.innerHTML = template;\n    return el;\n};\n\nclass AbstractView {\n  constructor() {\n    if (new.target === AbstractView) {\n      throw new Error(\"Can't instantiate AbstractView, only concrete one\");\n    }\n  }\n\n  get template() {\n    throw new Error('Template is required');\n  }\n\n  get element() {\n    if (this._element) {\n      return this._element;\n    }\n\n    this._element = this.render();\n    this.bind(this._element);\n\n    return this._element;\n  }\n\n  render() {\n    return render(this.template);\n  }\n\n  bind() {\n  }\n\n  onClick() {\n  }\n}\n\nexport default AbstractView;\n","import AbstractView from './abstract-view.js';\n\nconst renderTripItem = (trip) => {\n  trip = trip['_source'];\n  return `\n    <li class=\"trip trips__item\" id=\"${trip.id}\">\n      <a href=\"/#${trip.pretty_url}\" class=\"trip__link link js-link-trip\">\n        <div class=\"trip__pic\"><img src=\"${trip.mainPhoto}\" alt=\"${trip.experienceType} in ${trip.clean_city}, ${trip.country}\"></div>\n        <h3 class=\"trip__title\">${trip.title}</h3>\n      </a>\n      <div class=\"trip__content\">\n        <p class=\"trip__teaser\">${trip.teaser}</p> \n      </div>\n    </li>`;\n}\n\nexport default class TripListView extends AbstractView {\n  constructor(data) {\n    super();\n    this.trips = data;\n  } \n\n  get template() {\n    return `\n      <ul class=\"trips\">\n        ${this.trips.map((trip) => renderTripItem(trip)).join('')}\n      </ul>`;\n  }\n\n  onClick() {\n  }\n\n  bind() {\n    const linkTrip = this.element.querySelectorAll('.js-link-trip');\n\n    linkTrip.forEach((item) => {\n      item.addEventListener('click', (e) => {\n        const tripId = e.currentTarget.closest('.trip').id;\n        this.onClick(tripId);\n      });\n    });\n  }\n}\n","import Application from './app.js';\nimport TripListView from './trip-list-view.js';\n\nclass TripListInstance {\n  constructor(data) {\n    this.data = data;\n    this.template = new TripListView(this.data);\n    this.element = this.template.element;\n\n    this.template.onClick = (tripId) => {\n      Application.showTripPage(tripId);\n    };\n  }\n}\n\nexport default TripListInstance;\n","import AbstractView from './abstract-view.js';\n\nconst renderHost = (host) => {\n  const hostTpl = `\n    <li class=\"trip__host host\">\n      <a href=\"${host.pretty_url}\" class=\"link\">\n        <span class=\"host__pic\" style=\"background-image: url(${host.photo})\"></span>\n        <span class=\"host__name\">${host.fullName}</span>\n      </a>\n    </li>`;\n    \n  return hostTpl;\n}\n\nexport default class TripPageView extends AbstractView {\n  constructor(trip) {\n    super();\n    this.trip = trip['_source'];\n  } \n\n  get template() {\n    console.log(this.trip)\n    return `\n      <a href=\"/\" class=\"trip__back link js-back-to-trips\">Back to Trips</a>\n      <article class=\"trip-page\">\n        <h2 class=\"trip-page__title\">${this.trip.title} <span class=\"trip-page__fav\">Add to Favourites</span></h2>\n        <div class=\"trip-page__pic\"><img src=\"${this.trip.mainPhoto}\" alt=\"${this.trip.experienceType} in ${this.trip.clean_city}, ${this.trip.country}\"></div>\n        <p class=\"trip-page__teaser\">${this.trip.teaser}</p> \n        <ul class=\"trip-page__hosts\">${this.trip.hosts.map((host) => renderHost(host)).join('')}</ul>\n      </article>`;\n  }\n\n  onClick() {\n  }\n\n  bind() {\n    const backLink = this.element.querySelector('.js-back-to-trips');\n    \n    backLink.addEventListener('click', this.onClick);\n  }\n}\n","import Application from './app.js';\nimport TripPageView from './trip-page-view.js';\n\nclass TripPageInstance {\n  constructor(data) {\n    this.data = data;\n    this.template = new TripPageView(data);\n    this.element = this.template.element;\n\n    this.template.onClick = () => {\n      Application.showTripList();\n    };\n  }\n}\n\nexport default TripPageInstance;\n","import Loader from './loader.js';\nimport TripListInstance from './trip-list-screen.js';\nimport TripPageInstance from './trip-page-screen.js';\n\nlet tripList;\nlet tripListOriginals;\n\nconst mainElement = document.querySelector('#main');\n\nconst showPage = (element) => {\n  mainElement.innerHTML = '';\n  mainElement.appendChild(element);\n};\n\nclass Application {\n  static init() {\n    Loader.loadData()\n      .then((data) => {\n        tripList = data.all.hits.hits; \n        tripListOriginals = tripList.filter(item => (item['_source'].is_originals));\n        Application.showTripList();\n      })\n      .catch((err) => {\n        throw new Error('Error: ' + err);\n      });\n      \n  }\n\n  static showTripList() {\n    const tripListInstance = new TripListInstance(tripListOriginals);\n    showPage(tripListInstance.element);\n  }\n\n  static showTripPage(tripId) {\n    const currentTrip = tripListOriginals.filter(item => (item['_source']['id'] === tripId));\n    const tripPage = new TripPageInstance(currentTrip[0]);\n    showPage(tripPage.element);\n  }\n}\n\nexport default Application;\n","import Application from './app.js';\n\ndocument.addEventListener('DOMContentLoaded', Application.init());\n"],"names":[],"mappings":";;;AAAA,MAAM,UAAU,GAAG,qNAAqN,CAAC;;AAEzO,MAAM,WAAW,GAAG,CAAC,QAAQ,KAAK;EAChC,IAAI,QAAQ,CAAC,MAAM,IAAI,GAAG,IAAI,QAAQ,CAAC,MAAM,GAAG,GAAG,EAAE;IACnD,OAAO,QAAQ,CAAC;GACjB;EACD,MAAM,IAAI,KAAK,CAAC,CAAC,EAAE,QAAQ,CAAC,MAAM,CAAC,EAAE,EAAE,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC;CAC/D,CAAC;;AAEF,MAAM,MAAM,GAAG,CAAC,QAAQ,KAAK,QAAQ,CAAC,IAAI,EAAE,CAAC;;AAE7C,MAAM,MAAM,CAAC;EACX,OAAO,QAAQ,GAAG;IAChB,OAAO,UAAU,CAAC,CAAC,EAAE,UAAU,CAAC,CAAC,CAAC;OAC/B,IAAI,CAAC,WAAW,CAAC;OACjB,IAAI,CAAC,MAAM,CAAC,CAAC;GACjB;CACF,AAED,AAAsB;;ACnBtB,MAAM,MAAM,GAAG,CAAC,QAAQ,KAAK;IACzB,MAAM,EAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;IAC7C,EAAE,CAAC,SAAS,GAAG,QAAQ,CAAC;IACxB,OAAO,EAAE,CAAC;CACb,CAAC;;AAEF,MAAM,YAAY,CAAC;EACjB,WAAW,GAAG;IACZ,IAAI,GAAG,CAAC,MAAM,KAAK,YAAY,EAAE;MAC/B,MAAM,IAAI,KAAK,CAAC,mDAAmD,CAAC,CAAC;KACtE;GACF;;EAED,IAAI,QAAQ,GAAG;IACb,MAAM,IAAI,KAAK,CAAC,sBAAsB,CAAC,CAAC;GACzC;;EAED,IAAI,OAAO,GAAG;IACZ,IAAI,IAAI,CAAC,QAAQ,EAAE;MACjB,OAAO,IAAI,CAAC,QAAQ,CAAC;KACtB;;IAED,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;IAC9B,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;;IAEzB,OAAO,IAAI,CAAC,QAAQ,CAAC;GACtB;;EAED,MAAM,GAAG;IACP,OAAO,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;GAC9B;;EAED,IAAI,GAAG;GACN;;EAED,OAAO,GAAG;GACT;CACF,AAED,AAA4B;;ACrC5B,MAAM,cAAc,GAAG,CAAC,IAAI,KAAK;EAC/B,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;EACvB,OAAO,CAAC;qCAC2B,EAAE,IAAI,CAAC,EAAE,CAAC;iBAC9B,EAAE,IAAI,CAAC,UAAU,CAAC;yCACM,EAAE,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC;gCAC9F,EAAE,IAAI,CAAC,KAAK,CAAC;;;gCAGb,EAAE,IAAI,CAAC,MAAM,CAAC;;SAErC,CAAC,CAAC;CACV,CAAA;;AAED,AAAe,MAAM,YAAY,SAAS,YAAY,CAAC;EACrD,WAAW,CAAC,IAAI,EAAE;IAChB,KAAK,EAAE,CAAC;IACR,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;GACnB;;EAED,IAAI,QAAQ,GAAG;IACb,OAAO,CAAC;;QAEJ,EAAE,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;WACvD,CAAC,CAAC;GACV;;EAED,OAAO,GAAG;GACT;;EAED,IAAI,GAAG;IACL,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,eAAe,CAAC,CAAC;;IAEhE,QAAQ,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK;MACzB,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC,CAAC,KAAK;QACpC,MAAM,MAAM,GAAG,CAAC,CAAC,aAAa,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC;QACnD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;OACtB,CAAC,CAAC;KACJ,CAAC,CAAC;GACJ;CACF;;ACvCD,MAAM,gBAAgB,CAAC;EACrB,WAAW,CAAC,IAAI,EAAE;IAChB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACjB,IAAI,CAAC,QAAQ,GAAG,IAAI,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5C,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;;IAErC,IAAI,CAAC,QAAQ,CAAC,OAAO,GAAG,CAAC,MAAM,KAAK;MAClC,WAAW,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;KAClC,CAAC;GACH;CACF,AAED,AAAgC;;ACbhC,MAAM,UAAU,GAAG,CAAC,IAAI,KAAK;EAC3B,MAAM,OAAO,GAAG,CAAC;;eAEJ,EAAE,IAAI,CAAC,UAAU,CAAC;6DAC4B,EAAE,IAAI,CAAC,KAAK,CAAC;iCACzC,EAAE,IAAI,CAAC,QAAQ,CAAC;;SAExC,CAAC,CAAC;;EAET,OAAO,OAAO,CAAC;CAChB,CAAA;;AAED,AAAe,MAAM,YAAY,SAAS,YAAY,CAAC;EACrD,WAAW,CAAC,IAAI,EAAE;IAChB,KAAK,EAAE,CAAC;IACR,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC;GAC7B;;EAED,IAAI,QAAQ,GAAG;IACb,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;IACtB,OAAO,CAAC;;;qCAGyB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC;8CACT,EAAE,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;qCAClH,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC;qCACnB,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,KAAK,UAAU,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAChF,CAAC,CAAC;GACf;;EAED,OAAO,GAAG;GACT;;EAED,IAAI,GAAG;IACL,MAAM,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,CAAC,mBAAmB,CAAC,CAAC;;IAEjE,QAAQ,CAAC,gBAAgB,CAAC,OAAO,EAAE,IAAI,CAAC,OAAO,CAAC,CAAC;GAClD;CACF;;ACrCD,MAAM,gBAAgB,CAAC;EACrB,WAAW,CAAC,IAAI,EAAE;IAChB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACjB,IAAI,CAAC,QAAQ,GAAG,IAAI,YAAY,CAAC,IAAI,CAAC,CAAC;IACvC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;;IAErC,IAAI,CAAC,QAAQ,CAAC,OAAO,GAAG,MAAM;MAC5B,WAAW,CAAC,YAAY,EAAE,CAAC;KAC5B,CAAC;GACH;CACF,AAED,AAAgC;;ACXhC,IAAI,QAAQ,CAAC;AACb,IAAI,iBAAiB,CAAC;;AAEtB,MAAM,WAAW,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC,CAAC;;AAEpD,MAAM,QAAQ,GAAG,CAAC,OAAO,KAAK;EAC5B,WAAW,CAAC,SAAS,GAAG,EAAE,CAAC;EAC3B,WAAW,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC;CAClC,CAAC;;AAEF,MAAM,WAAW,CAAC;EAChB,OAAO,IAAI,GAAG;IACZ,MAAM,CAAC,QAAQ,EAAE;OACd,IAAI,CAAC,CAAC,IAAI,KAAK;QACd,QAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC;QAC9B,iBAAiB,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,KAAK,IAAI,CAAC,SAAS,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC;QAC5E,WAAW,CAAC,YAAY,EAAE,CAAC;OAC5B,CAAC;OACD,KAAK,CAAC,CAAC,GAAG,KAAK;QACd,MAAM,IAAI,KAAK,CAAC,SAAS,GAAG,GAAG,CAAC,CAAC;OAClC,CAAC,CAAC;;GAEN;;EAED,OAAO,YAAY,GAAG;IACpB,MAAM,gBAAgB,GAAG,IAAI,gBAAgB,CAAC,iBAAiB,CAAC,CAAC;IACjE,QAAQ,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;GACpC;;EAED,OAAO,YAAY,CAAC,MAAM,EAAE;IAC1B,MAAM,WAAW,GAAG,iBAAiB,CAAC,MAAM,CAAC,IAAI,KAAK,IAAI,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,KAAK,MAAM,CAAC,CAAC,CAAC;IACzF,MAAM,QAAQ,GAAG,IAAI,gBAAgB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC;IACtD,QAAQ,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;GAC5B;CACF,AAED,AAA2B;;ACtC3B,QAAQ,CAAC,gBAAgB,CAAC,kBAAkB,EAAE,WAAW,CAAC,IAAI,EAAE,CAAC,CAAC,;;"}